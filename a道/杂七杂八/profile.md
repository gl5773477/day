---

## ymt相关工作
### gfw网关
### 无损升级
### 三方渠道
### 加密机
### docker迁移
### 订单系统
### 支付系统

>未涵盖的工作：hadoop、kafaka、flume、spark、日志追踪（不属于我们的业务，但是代码是共享的）、账务。

---

#### 支付系统3.0架构
- 架构思想：
  - 每一个模块的设计思路
- 业务难点：
  - [ x ] 事务锁：select for update
  - [ x ] 无损升级
  - [ x ] 加密机 
  - 逻辑复杂的比如：拼团逻辑、go get代理问题

- 技术难点： 
  包的依赖管理问题。
  - 如果需要翻墙的包，需要设置代理，有些包不支持socks5代理，则需要做协议转换
  - go get，对于私有仓库，不能使用代理，可是他依赖一些三方包，而这些包需要代理，矛盾，因为如果go get -u，则同时会更新依赖包。解决办法是，私有仓库暂时使用git clone xxx dstDIR

- mysql锁的难题
- 分布式事务的回滚问题，设计账务
- k8s有损上线问题
- 订单的状态机，相关的定时任务设计


1. 拼团逻辑
一个城市一个产品只能有一个进行中的拼团。
第一个支付成功的才是团主。
团主可能直接成团。
任何一个参团的支付成功时，可能原有的团已经失效或成功，则立即开新团。
开新团可能直接成团了。

---

## token、sessionkey，登录安全机制
## 账务系统
## 订单系统

- 会计六大科目：资产、负债、所有者权益、收入、费用、利润。
- 借贷关系：有借必有贷，借贷必相等。
- 资产、费用如果增加，则属于借方；此时，负债科目一方就是贷方。
- 举例：账户充值。对于平台而言，用户的账户属于负债科目，负债科目金额增加，则属于贷方；此时需要一个借方对应，则平台的待清算账户为借方，即待清算也要增加，并计入借方。
- 反之，账户消费。对于平台而言，负债科目金额减少，计入借方；而待清算计入贷方。

一个类似于支付宝的支付系统。面向商户，提供收款、付款、转账、提现和退款等功能。
任何一个商户可以是公司内部的其他业务，也可以是其他公司的业务，只要接入了这套支付系统，就算是一个商户。